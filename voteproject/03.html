<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>投票项目前端</title>
</head>
<body>
<p>一上来其实我前端是有点懵逼的，压根没想好怎么写。</p>
<p>倒不是懵逼在项目的样式怎么配，好看不好看这种问题，而是Vue才刚刚看完，还没有写过什么实际项目，这次就要直接上了，逻辑有点混乱，不过确实刺激。</p>
<p>想了一下，既然逻辑还不是很清晰，就先从最简单的入手，想象一下页面进来以后会发生什么事情，然后一点一点实现就可以了。</p>
<h1>项目初始化</h1>
<p>麻雀虽小，五脏俱全，通过Vue-CLI 3直接创建项目，然后导入bootstrap 和依赖的jquery和popper.js库：</p>
<pre>
npm install bootstrap --save
npm install jquery --save
npm install --save popper.js
</pre>
<p>然后在main.js里导入这三个东西：</p>
<pre>
import "bootstrap/dist/css/bootstrap.min.css"
import "jquery/dist/jquery.min"
import "popper.js/dist/popper.min"
</pre>
<p>不过这里只是为了方便开发之用，以让IDE可以认出来CSS类和不影响本地工作，在完成开发之后，应该在index.html中加入上述三个类的链接。</p>
<p>当然愿意的话，也可以直接用dist中的文件。</p>

<h1>简单的View和组件设计</h1>
<p>简单想了一下流程，分开两个视图，一个是登录视图（路径为<code>/login</code>)，组件为登录表单；一个是展示投票页面的视图(路径为是根路径)，组件是投票表单+登录展示。</p>
<p>主要业务逻辑如下：</p>
<ol>
    <li>
        项目初始化
        <ol>
            <li>vuex从本地加载TOKEN和用户名</li>
        </ol>
    </li>
    <li>用户访问首页
        <ol>
            <li>before导航守卫判断vuex中是否有TOKEN，没有则转至登录视图
            <li>如果有TOKEN，向后端发送TOKEN获取投票信息
                <ol>
                    <li>正常获得响应--正常进入投票视图</li>
                    <li>出现任何错误，表示TOKEN认证失败--转至登录视图</li>
                </ol>
            </li>
        </ol>
    </li>
    <li>
        用户访问登录视图
        <ol>
            <li>导航守卫不做任何验证-->所有用户都可以访问登录视图</li>
            <li>用户发送登录请求-->成功取得200响应且响应头内有TOKEN-->将TOKEN和用户名，是否投票，到期时间等信息加载至Vuex并存储到本地存储中，然后转至首页。</li>
            <li>用户发送登录请求-->返回任何错误代码-->依然返回登录视图，但是需要通过SLOT插入错误信息。</li>
        </ol>
    </li>
    <li>
        用户选择了组件之后点击发送按钮
        <ol>
            <li>如果获取201响应，则表示成功进行投票。</li>
            <li>如果获取406响应，表示用户还在冷却中，弹出提示每24小时只能投一次票，什么也不做。</li>
            <li>如果获取403响应，表示TOKEN出现问题，将用户转至登录页面。</li>
        </ol>
    </li>
</ol>







</body>
</html>
