<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>项目记录</title>

</head>
<body>
<h1 style="text-align: center;">第一个项目</h1>
<p>学编程，一定要写一个东西出来，单独的那些小练习最多练练算法，但练不了实际解决问题的能力。</p>
<p>在去年的10-11月，为公司写过一个<a href="https://github.com/minkolee/ContractCMS" target="_blank">合同管理项目</a>，是我学了Web开发之后写的第一个项目。</p>
<p>当时由于这方面的需求比较强烈，公司又没有一个像样的信息系统，就前后花了两个星期的时间，和其他部门开会问需求，然后写出初版进行测试，最后正式上线。虽然都不是什么非常正式的项目，但总算也经历过了一个完整的开发。</p>
<p>就在10天前，还更新到了1.1版本，添加了两个公司的支持。</p>
<p>现在回头来看看这个项目，使用的技术栈并不复杂，后端是Python 3.7 + Django 2.1.1，数据库使用了PostgreSQL。前端由于当时还没学前后端分离，又不想用Bootstrap，就用了<a href="https://foundation.zurb.com/" target="_blank">Foundation库</a>，排版布局稍微比Bootstrap方便一些。</p>
<p>业务逻辑除了用户登录，还有一个根据数据库中已经存在的该类合同的数量自动编制索引之外，就全部都是CRUD了。用户方面分成合约部分录入合同信息，工程和前期部分请款，财务部分记录付款。还靠Django ORM对PostgreSQL的支持简单的写了一个查找功能。</p>
<p>虽然业务超级简单，但各个部门有了一个共享的信息平台和记录，给内部管理和外部审计都带来了很大的方便。年底事务所来审计的时候就对这个东西赞不绝口。</p>
<p>项目刚上线的时候，默认是只支持一个公司，不过我当时还算明智，在数据库里留好了公司表，然后合同默认外链到第一个公司，所以在这个月增加新公司支持的时候，只做了很小的改动，在录入合同的表单内添加了公司就可以了。看来当时我写的代码耦合程度还算是比较低的。</p>
<p>当然，这不是说这个项目有多酷炫。其实在我看来，第一个项目就像是一个锤子，简单实用能起到效果，但是外观实在太不起眼。实际的页面是这个风格：</p>
<img src="http://img.conyli.cc/django2/cms.jpg" alt="">
<p>被一起学开发的朋友吐槽说这是工业水泥风，让我赶紧把UI换了。不过由于现在一直工作稳定，也满足了现在的需求，估计短期内不会升级了，也许哪天会用Java来写2.0版本了。</p>
<p>然而，真正要升级的不是这个项目的外观，而是技术栈。</p>

<h1 style="text-align: center;">下一个项目</h1>
<p>去年有幸认识身边的一个前端架构师，他看我对Web开发如此有兴趣给我推荐了一套音频讲座：<a href="https://time.geekbang.org/column/intro/48" target="_blank">左耳听风的讲座</a>。在其中的程序员练级攻略里，我发现我自己其实已经完成了里边的零基础启蒙的部分。</p>
<p>同时被打击了一下，原来以为自己入门了，但是在大佬看来完成了Python Web开发也只算是启蒙，在<a href="http://www.conyli.cc/2019.html" target="_blank">正式入门</a>的篇章里，大佬提出了要转到Java上来才算入门的要求。</p>
<p>所以从去年年底，就转到Java上来，不断积累技术栈，学习Spring，Vue等前后端分离技术。现在感觉差不多可以一战了，就准备在博客上开个项目一栏，记录一下升级后的自己，对于完成这个项目的点点滴滴，也是又一次对自己的审视吧。</p>
<p>这个项目的具体要求是：</p>
<h3>实践项目</h3>
<p>一个投票项目：</p>
<ol>业务需求如下：
<li>用户只有在登录后，才可以生成投票表单。</li>
<li>投票项可以单选，可以多选。</li>
<li>其它用户投票后显示当前投票结果（但是不能刷票）。</li>
<li>投票有相应的时间，页面上需要出现倒计时。</li>
<li>投票结果需要用不同颜色不同长度的横条，并显示百分比和人数。</li>
</ol>
<ol>技术需求如下：
    <li>这回要用Java Spring Boot来实现了，然后，后端不返回任何的HTML，只返回JSON数据给前端</li>
    <li>由前端的JQuery来处理并操作相关的HTML动态生成在前端展示的页面</li>
    <li>前端的页面还要是响应式的，也就是可以在手机端和电脑端有不同的呈现。 这个可以用Bootstrap来完成。</li>
</ol>
<ol>进阶功能：
    <li>在微信中，通过微信授权后记录用户信息，以防止刷票。</li>
    <li>可以不用刷页面，就可以动态地看到投票结果的变化。</li>
    <li>Google一些画图表的JavaScript库，然后把图表画得风骚一些。</li>
</ol>
<p>现在既然准备开始做这个项目了，也拿到需求了，就得先分析分析技术选型了。博客估计要变成项目文档了，这大概是Blog-Drive</p>

<h1 style="text-align: center;">技术准备</h1>
<p>把上边的需求分析了一下：</p>
<table border="1">
    <thead>
    <tr>
        <th>需求内容</th>
        <th>需求分析和技术</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>项目基础结构</td>
        <td>Java+Spring（Boot)，Spring Boot的依赖要根据每个需求而定</td>
    </tr>
    <tr>
        <td>用户登录后生成投票表单</td>
        <td>由于后边大佬提出要前后端分离，不能使用Spring Security，要使用Shiro安全框架加jjwt。这个还需要学习，找了一篇<a href="https://zhuanlan.zhihu.com/p/30155904" target="_blank">文章</a>。</td>
    </tr>
    <tr>
        <td>投票项可以单选，可以多选</td>
        <td>这个倒是容易，就是把投票选项做成checkbox控件。</td>
    </tr>
    <tr>
        <td>其它用户投票后显示当前投票结果（但是不能刷票）。</td>
        <td>这个就是指用户只能投票才能查看投票结果，从设想上来看，应该就是投票发送请求之后，如果响应成功，就应该返回结果页面，不成功则弹出提示。</td>
    </tr>
    <tr>
        <td>投票有相应的时间，页面上需要出现倒计时。</td>
        <td>这个可以使用JS控件来完成，只是要通过HTML或者其他方式传递数据。也可以考虑在新一些的浏览器上通过SSE来实现（似乎推送时间）没有必要。</td>
    </tr>
    <tr>
        <td>投票结果需要用不同颜色不同长度的横条，并显示百分比和人数</td>
        <td>这个是具体样式了，可以通过前端来计算，或者后端返回也可以</td>
    </tr>
    <tr>
        <td>后端不返回任何的HTML，只返回JSON数据给前端</td>
        <td>这实际上是要求做一个单页面应用。要仔细规划一下。由于是投票，很容易想到，投票内容可以保存在Redis的有序集合中，因此需要集成Redis。而用户可以通过redis或者mongo来保存。</td>
    </tr>
    <tr>
        <td>由前端的JQuery来处理并操作相关的HTML动态生成在前端展示的页面</td>
        <td>说明这里需要使用jQuery</td>
    </tr>
    <tr>
        <td>响应式页面</td>
        <td>这个就按照大佬说的，使用Bootstrap了</td>
    </tr>
    <tr>
        <td>通过微信授权后记录用户信息</td>
        <td>这个很显然，如果要做到前后端分离，就要使用Oauth2认证，不过搜了一下，发现企业号才能使用，暂时无法做该功能。</td>
    </tr>
    <tr>
        <td>可以不用刷页面，就可以动态地看到投票结果的变化</td>
        <td>这个可以采用两个方案：如果客户端支持，就采用SSE；如果不支持，就采用轮询的方式。如果要采用SSE的方式，则必须使用Spring Webflux。</td>
    </tr>
    </tbody>
</table>
<p>由于既然要做项目就要努力把挑战都完成。分析到现在，我发现这基本上就是要做一个单页面应用。</p>
<p>主要用的技术有：</p>
<ol>后端
    <li><code>Spring Boot</code></li>
    <li><code>Shiro安全框架</code></li>
    <li>数据库方面<code>Hibernate</code>+<code>MySQL</code>+<code>Redis</code></li>
</ol>
<ol>前端
    <li><code>Vue</code></li>
    <li><code>Bootstrap</code></li>
</ol>
<p>发现还缺失Vue相关的一些路由，以及前后端分离用户鉴权的知识。</p>



</body>
</html>