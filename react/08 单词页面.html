<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>React 08 单词页面</title>
</head>
<body>
<p>为了提高英语阅读水平, 找朋友要了一个GRE 官方核心词汇3300个, 打算加上阅读来大量使用了.</p>
<p>之前其实也做好了相关准备, 比如手机上装好了mdict, 电脑上有golden dict, 准备开始用透析法来阅读原著, 然后有事没事就开始听东西.</p>
<p>不过由于单词都存放在Excel中, 因此准备写一段程序, 把单词提取出来, 然后做一个页面, 用来提醒自己, 顺便就练习一下React和material-ui吧.</p>

<ol>
    <li><a href="#con1">提取单词成为JSON文件</a></li>
    <li><a href="#con2">最基础的APP类</a></li>
    <li><a href="#con3"></a></li>
    <li><a href="#con4">更改目标区域的颜色</a></li>
</ol>

<h2 style="text-align: center;" id="con1">提取单词成为JSON文件</h2>
<p>这个用Python来操作就行了, 提取很方便. 准备提取成一个数组, 其中每个元素是一个对象, 属性如下: name是单词, meaning是单词的释义, 记住与否是该词是否记住, 是一个布尔值.</p>
<p>在用Python处理的过程中, 发现了一些错误, 以及无法识别成unicode, 还发现一些单词缺少释义, 都补完了. </p>
<pre>
import random
import openpyxl

wb = openpyxl.open('words.xlsx')
names = wb.sheetnames[:-1]

def generateOnePair(word: str, explanation: str) -> str:
    return '{' +'name:"{}", meaning:"{}", remembered: false'.format(word, explanation)+'},'


count = 0
newfileIndex = 1
file = open('words.js', "wb+")
newWb = openpyxl.Workbook()
wordSheet = newWb.active
file.write('const words = ['.encode(encoding='UTF-8', errors='strict'))

for name in names:
    ws = wb[name]
    for i in range(1, ws.max_row + 1):
        if (ws.cell(row=i, column=1).value):
            count += 1
            word = ws.cell(row=i, column=1).value.replace("\n","")
            explanation = ws.cell(row=i, column=2).value.replace('\n',"")
            file.write(generateOnePair(word, explanation).encode(encoding='UTF-8', errors='strict'))
            wordSheet.cell(row=newfileIndex, column=1, value=word)
            wordSheet.cell(row=newfileIndex, column=2, value=explanation)
            newfileIndex += 1

file.write('];\nexport default words;'.encode(encoding='UTF-8', errors='strict'))

file.close()

newWb.save("result.xlsx")
</pre>
<p>代码很简单, 读取一下全部的单词和释义, 拼接成JS的对象, 然后再把结果也保存一份成为excel文件, 这样就毫无感情的统计好了生词以及生成了JSON文件, 接下来就是渲染.</p>

<h2 style="text-align: center;" id="con2">最基础的APP类</h2>
<p>由于已经有了words.js, 就方便多了, 可以直接导入APP类中, 不过在此之前, 还是来使用一下<a href="https://material-ui.com/" target="_blank">material-ui</a>的搭配吧.</p>
<p></p>








<h2 style="text-align: center;" id="con3">Redux的理念</h2>
<h2 style="text-align: center;" id="con4">Redux的理念</h2>




</body>
</html>